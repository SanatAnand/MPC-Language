% !TeX encoding = UTF-8
% !TeX root = ../report.tex

\section{Grammar}
\begin{grammar}
<program> ::= <protocol\_list>

<protocol\_list> ::= <protocol> \alt <protocol> <protocol\_list>

<protocol> ::= <prot\_decl> '\{' <opt\_uses> <statement\_list> '\}'

<prot\_decl> ::= PROTOCOL NAME '(' <opt\_arg\_list> ')' ':' PARTY <p\_list>

<p\_list> ::= <p\_list\_elem> \alt <p\_list> ',' <p\_list\_elem>

<p\_list\_elem> ::= <exp> \alt <in\_decl>

<in\_decl> ::= IN <opt\_each> <term> '\{' <decl\_list> '\}'

<decl\_list> ::= <decl> \alt <decl> ';' <decl\_list>

<decl> ::= <type> <varlist>

<opt\_arg\_list> ::= $\epsilon$ \alt <arg\_list>

<arg\_list> ::= <arg> \alt <arg> ',' <arg\_list>

<arg> ::= <type> <term> \alt '(' <prot\_decl> ')'

<term> ::= <var> <dimlist> \alt ENV \alt IDEAL \alt RAND\_PORT \alt ENV\_PORT

<dimlist> ::= $\epsilon$ \alt '[' <exp> ']' <dimlist> \alt '[' ']' <dimlist>

<exp> ::= <exp> '+' <exp> \alt <exp> '-' <exp> \alt <exp> '*' <exp> \alt <exp> '/' <exp> \alt '-' <exp> \alt <exp> B\_AND <exp> \alt <exp> OR <exp> \alt NOT <exp> \alt <exp> EQ <exp> \alt <exp> LT <exp> \alt <exp> GT <exp> \alt <exp> NE <exp> \alt <exp> LE <exp> \alt <exp> GE <exp> \alt '(' <exp> ')' \alt <exp> '|' <exp> \alt <exp> '.' <exp> \alt <exp\_list> \alt <fixed\_list> \alt <term>

<fixed\_list> ::= DOUBLE\_OPEN <exp> DOUBLE\_DOT <exp> DOUBLE\_CLOSE

<var> ::= NAME \alt '\#' NAME \alt '@' \alt RAND \alt <constant>

<opt\_uses> ::= $\epsilon$ \alt USES <prot\_decl\_list> ';'

<prot\_decl\_list> ::= <prot\_decl> \alt <prot\_decl> <prot\_decl\_list>

<statement\_list> ::= <statement> \alt <statement\_list> <statement>

<statement> ::= <assignment\_statement> \alt <mult\_statement> \alt <pvt\_statement> \alt <send\_statement> \alt <session\_call> \alt <tying\_statement> \alt <declaration\_statement> \alt <protocol> \alt <loop\_statement> \alt <cond\_statement> \alt <wrap\_statement> \alt <connect\_statement> \alt <abort\_statement> \alt <seq\_statement> \alt <start\_statement> \alt <set\_statement> \alt <forward\_statement>

<abort\_statement> ::= ABORTING ';'

<wrap\_statement> ::= WRAP <exp> <statement>

<start\_statement> ::= START <exp> ';'

<seq\_statement> ::= BEFORE <opt\_each> <statement> DO <statement> \alt AFTER <opt\_each> <statement> DO <statement>

<opt\_each> ::= $\epsilon$ \alt EACH

<assignment\_statement> ::= <exp> ASSIGN <exp> ';'

<mult\_statement> ::= '\{' <statement\_list> '\}'

<pvt\_statement> ::= IN <opt\_each> <term> '\{' <statement\_list> '\}'

<send\_statement> ::= <exp> SEND <exp> ';'

<session\_call> ::= <opt\_partial> OPEN <term> AS <prot\_call> '\{' <statement\_list> '\}'

<opt\_partial> ::= $\epsilon$ \alt PARTIAL

<prot\_call> ::= NAME '(' <opt\_id\_list> ')'

<opt\_id\_list> ::= $\epsilon$ \alt <id\_list>

<id\_list> ::= <variable> \alt <id\_list> ',' <variable>

<tying\_statement> ::= <exp> ':' <exp> ';'

<declaration\_statement> ::= <type> <varlist> ';'

<type> ::= PARTY \alt INTEGER \alt SESSION \alt UNKNOWN \alt PORT \alt INPORT \alt OUTPORT \alt BOOL \alt FIELD \alt NAME

<varlist> ::= <term> \alt <term> ',' <varlist>

<loop\_statement> ::= FOR EACH <variable> OF <exp> <opt\_cond> <statement> \alt FOR EACH <exp> <opt\_cond> <statement> \alt FOR EACH <variable> OF <exp> <statement> \alt FOR EACH <exp> <statement>

<opt\_cond> ::= EXCEPT <exp> \alt WHERE <exp>

<cond\_statement> ::= IF '(' <exp> ')' <statement> \alt IF '(' <exp> ')' <statement> ELSE <statement>

<set\_statement> ::= SET <exp> AS <prot\_call> DOUBLE\_COLON <exp> ';'

<connect\_statement> ::= CONNECT <exp> <to\_and> <exp> ';'

<to\_and> ::= TO \alt AND

<exp\_list> ::= '\{' <exp\_list\_elem> '\}'

<exp\_list\_elem> ::= <exp> \alt <exp\_list\_elem> ',' <exp>

<forward\_statement> ::= FORWARD <exp> TO <exp> ';'

<variable> ::= NAME

<constant> ::= INTEGER\_NUMBER

\end{grammar}
