% !TeX encoding = UTF-8
% !TeX root = ../report.tex

\section{Grammar}
\begin{grammar}
<program> ::= <protocol\_list>

<protocol\_list> ::= <protocol> \alt <protocol> <protocol\_list>

<protocol> ::= <prot\_decl> \lq\{\rq <opt\_uses> <statement\_list> \lq\}\rq

<prot\_decl> ::= PROTOCOL NAME \lq(\rq <opt\_arg\_list> \lq)\rq \lq:\rq PARTY <p\_list>

<p\_list> ::= <p\_list\_elem> \alt <p\_list> \lq,\rq <p\_list\_elem>

<p\_list\_elem> ::= <exp> \alt <in\_decl>

<in\_decl> ::= IN <opt\_each> <term> \lq\{\rq <decl\_list> \lq\}\rq

<decl\_list> ::= <decl> \alt <decl> \lq;\rq <decl\_list>

<decl> ::= <type> <varlist>

<opt\_arg\_list> ::= $\epsilon$ \alt <arg\_list>

<arg\_list> ::= <arg> \alt <arg> \lq,\rq <arg\_list>

<arg> ::= <type> <term> \alt \lq(\rq <prot\_decl> \lq)\rq

<term> ::= <var> <dimlist> \alt ENV \alt IDEAL \alt RAND\_PORT \alt ENV\_PORT

<dimlist> ::= $\epsilon$ \alt \lq[\rq <exp> \lq]\rq <dimlist> \alt \lq[\rq \lq]\rq <dimlist>

<exp> ::= <exp> '+' <exp> \alt <exp> '-' <exp> \alt <exp> '*' <exp> \alt <exp> '/' <exp> \alt '-' <exp> \alt <exp> B\_AND <exp> \alt <exp> OR <exp> \alt NOT <exp> \alt <exp> EQ <exp> \alt <exp> LT <exp> \alt <exp> GT <exp> \alt <exp> NE <exp> \alt <exp> LE <exp> \alt <exp> GE <exp> \alt \lq(\rq <exp> \lq)\rq \alt <exp> '|' <exp> \alt <exp> '.' <exp> \alt <exp\_list> \alt <fixed\_list> \alt <term>

<fixed\_list> ::= DOUBLE\_OPEN <exp> DOUBLE\_DOT <exp> DOUBLE\_CLOSE

<var> ::= NAME \alt '\#' NAME \alt '@' \alt RAND \alt <constant>

<opt\_uses> ::= $\epsilon$ \alt USES <prot\_decl\_list> \lq;\rq

<prot\_decl\_list> ::= <prot\_decl> \alt <prot\_decl> <prot\_decl\_list>

<statement\_list> ::= <statement> \alt <statement\_list> <statement>

<statement> ::= <assignment\_statement> \alt <mult\_statement> \alt <pvt\_statement> \alt <send\_statement> \alt <session\_call> \alt <tying\_statement> \alt <declaration\_statement> \alt <protocol> \alt <loop\_statement> \alt <cond\_statement> \alt <wrap\_statement> \alt <connect\_statement> \alt <abort\_statement> \alt <seq\_statement> \alt <start\_statement> \alt <set\_statement> \alt <forward\_statement>

<abort\_statement> ::= ABORTING \lq;\rq

<wrap\_statement> ::= WRAP <exp> <statement>

<start\_statement> ::= START <exp> \lq;\rq

<seq\_statement> ::= BEFORE <opt\_each> <statement> DO <statement> \alt AFTER <opt\_each> <statement> DO <statement>

<opt\_each> ::= $\epsilon$ \alt EACH

<assignment\_statement> ::= <exp> ASSIGN <exp> \lq;\rq

<mult\_statement> ::= \lq\{\rq <statement\_list> \lq\}\rq

<pvt\_statement> ::= IN <opt\_each> <term> \lq\{\rq <statement\_list> \lq\}\rq

<send\_statement> ::= <exp> SEND <exp> \lq;\rq

<session\_call> ::= <opt\_partial> OPEN <term> AS <prot\_call> \lq\{\rq <statement\_list> \lq\}\rq

<opt\_partial> ::= $\epsilon$ \alt PARTIAL

<prot\_call> ::= NAME \lq(\rq <opt\_id\_list> \lq)\rq

<opt\_id\_list> ::= $\epsilon$ \alt <id\_list>

<id\_list> ::= <variable> \alt <id\_list> \lq,\rq <variable>

<tying\_statement> ::= <exp> \lq:\rq <exp> \lq;\rq

<declaration\_statement> ::= <type> <varlist> \lq;\rq

<type> ::= PARTY \alt INTEGER \alt SESSION \alt UNKNOWN \alt PORT \alt INPORT \alt OUTPORT \alt BOOL \alt FIELD \alt NAME

<varlist> ::= <term> \alt <term> \lq,\rq <varlist>

<loop\_statement> ::= FOR EACH <variable> OF <exp> <opt\_cond> <statement> \alt FOR EACH <exp> <opt\_cond> <statement> \alt FOR EACH <variable> OF <exp> <statement> \alt FOR EACH <exp> <statement>

<opt\_cond> ::= EXCEPT <exp> \alt WHERE <exp>

<cond\_statement> ::= IF \lq(\rq <exp> \lq)\rq <statement> \alt IF \lq(\rq <exp> \lq)\rq <statement> ELSE <statement>

<set\_statement> ::= SET <exp> AS <prot\_call> DOUBLE\_COLON <exp> \lq;\rq

<connect\_statement> ::= CONNECT <exp> <to\_and> <exp> \lq;\rq

<to\_and> ::= TO \alt AND

<exp\_list> ::= \lq\{\rq <exp\_list\_elem> \lq\}\rq

<exp\_list\_elem> ::= <exp> \alt <exp\_list\_elem> \lq,\rq <exp>

<forward\_statement> ::= FORWARD <exp> TO <exp> \lq;\rq

<variable> ::= NAME

<constant> ::= INTEGER\_NUMBER

\end{grammar}
