% generated by Ott 0.25 from: grammar.ott
\documentclass[11pt]{article}
\usepackage{amsmath,amssymb}
\usepackage{supertabular}
\usepackage{geometry}
\usepackage{ifthen}
\usepackage{alltt}%hack
\geometry{a4paper,dvips,twoside,left=22.5mm,right=22.5mm,top=20mm,bottom=30mm}
\usepackage{color}
\newcommand{\ottdrule}[4][]{{\displaystyle\frac{\begin{array}{l}#2\end{array}}{#3}\quad\ottdrulename{#4}}}
\newcommand{\ottusedrule}[1]{\[#1\]}
\newcommand{\ottpremise}[1]{ #1 \\}
\newenvironment{ottdefnblock}[3][]{ \framebox{\mbox{#2}} \quad #3 \\[0pt]}{}
\newenvironment{ottfundefnblock}[3][]{ \framebox{\mbox{#2}} \quad #3 \\[0pt]\begin{displaymath}\begin{array}{l}}{\end{array}\end{displaymath}}
\newcommand{\ottfunclause}[2]{ #1 \equiv #2 \\}
\newcommand{\ottnt}[1]{\mathit{#1}}
\newcommand{\ottmv}[1]{\mathit{#1}}
\newcommand{\ottkw}[1]{\mathbf{#1}}
\newcommand{\ottsym}[1]{#1}
\newcommand{\ottcom}[1]{\text{#1}}
\newcommand{\ottdrulename}[1]{\textsc{#1}}
\newcommand{\ottcomplu}[5]{\overline{#1}^{\,#2\in #3 #4 #5}}
\newcommand{\ottcompu}[3]{\overline{#1}^{\,#2<#3}}
\newcommand{\ottcomp}[2]{\overline{#1}^{\,#2}}
\newcommand{\ottgrammartabular}[1]{\begin{supertabular}{llcllllll}#1\end{supertabular}}
\newcommand{\ottmetavartabular}[1]{\begin{supertabular}{ll}#1\end{supertabular}}
\newcommand{\ottrulehead}[3]{$#1$ & & $#2$ & & & \multicolumn{2}{l}{#3}}
\newcommand{\ottprodline}[6]{& & $#1$ & $#2$ & $#3 #4$ & $#5$ & $#6$}
\newcommand{\ottfirstprodline}[6]{\ottprodline{#1}{#2}{#3}{#4}{#5}{#6}}
\newcommand{\ottlongprodline}[2]{& & $#1$ & \multicolumn{4}{l}{$#2$}}
\newcommand{\ottfirstlongprodline}[2]{\ottlongprodline{#1}{#2}}
\newcommand{\ottbindspecprodline}[6]{\ottprodline{#1}{#2}{#3}{#4}{#5}{#6}}
\newcommand{\ottprodnewline}{\\}
\newcommand{\ottinterrule}{\\[5.0mm]}
\newcommand{\ottafterlastrule}{\\}
\newcommand{\ottmetavars}{
\ottmetavartabular{
 $ \ottmv{A} ,\, \ottmv{B} $ & \ottcom{Names of parties A, B} \\
 $ \wp $ & \ottcom{Protocol name $\wp$} \\
 $ \ottmv{x} ,\, \ottmv{y} ,\, \ottmv{s} $ & \ottcom{Variables Eg. Session or Integer variables.} \\
 $ \ottmv{env} $ & \ottcom{Special environment variable $\ottmv{env}$} \\
}}

\newcommand{\otttau}{
\ottrulehead{\tau}{::=}{\ottcom{Types}}\ottprodnewline
\ottfirstprodline{|}{\ottkw{Party}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottkw{Int}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottkw{Bool}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottkw{Session}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottkw{Port}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottkw{Field}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottkw{Protocol}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottsym{()}}{}{}{}{\ottcom{Well typed}}}

\newcommand{\ottprogram}{
\ottrulehead{\ottnt{program}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{ \ottnt{prtcl} ^+ }{}{}{}{\ottcom{One or more protocols}}}

\newcommand{\ottprtcl}{
\ottrulehead{\ottnt{prtcl}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{ \textbf{protocol} \  \wp  ( ( \tau  \  \ottmv{x} )^{+} ) \ \textbf{: party }  \ottmv{A} ^+
	    \{ \  \ottnt{statement} ^+ \ \} }{}{}{}{}}

\newcommand{\ottconstant}{
\ottrulehead{\ottnt{constant}  ,\ \ottnt{c}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\ottsym{integer\_literal}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottkw{true}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottkw{false}}{}{}{}{}}

\newcommand{\ottstatement}{
\ottrulehead{\ottnt{statement}  ,\ \ottnt{stmt}}{::=}{\ottcom{Statements}}\ottprodnewline
\ottfirstprodline{|}{ \textbf{in }  \ottmv{A}  \ \{ \  \ottnt{statement} ^+ \ \} }{}{}{}{\ottcom{Private statement}}\ottprodnewline
\ottprodline{|}{\tau \, \ottmv{x}  \ottsym{;}}{}{}{}{\ottcom{Declare a variable}}\ottprodnewline
\ottprodline{|}{\ottmv{env}  \Rightarrow  \ottmv{x}  \ottsym{;}}{}{}{}{\ottcom{Forward from env to var}}\ottprodnewline
\ottprodline{|}{\ottmv{x}  \Rightarrow  \ottmv{env}  \ottsym{;}}{}{}{}{\ottcom{Forward from var to env}}\ottprodnewline
\ottprodline{|}{\ottmv{x}  \ottsym{=}  \ottnt{exp}  \ottsym{;}}{}{}{}{\ottcom{Assignment}}\ottprodnewline
\ottprodline{|}{ \textbf{open} \  \ottmv{s}  \ \textbf{as }  \wp  (  \ottmv{x}  ) \ \{ \ ( \ottmv{A} : \ottmv{B} )^+ \ \} }{}{}{}{\ottcom{Open session $\ottmv{s}$}}\ottprodnewline
\ottprodline{|}{ \textbf{set} \  \ottmv{A}  \ \textbf{as} \  \wp  (  \ottmv{x} ^* ) \ \textbf{::} \  \ottmv{B} }{}{}{}{\ottcom{Set party as another party of another protocol}}\ottprodnewline
\ottprodline{|}{\ottnt{exp}  \Rightarrow  \ottnt{exp'}}{}{}{}{\ottcom{Forward from a exp to exp}}\ottprodnewline
\ottprodline{|}{ \textbf{wrap} \ \{  \mathcal{W}_{stmt} ^+ \} }{}{}{}{\ottcom{Wrap statement}}\ottprodnewline
\ottprodline{|}{ \textbf{connect} \  \mathcal{P}_{exp}  \ \textbf{and} \  \mathcal{P}_{exp}' }{}{}{}{\ottcom{Duplex connection}}\ottprodnewline
\ottprodline{|}{ \textbf{connect} \  \mathcal{P}_{exp}  \ \textbf{to} \  \mathcal{P}_{exp}' }{}{}{}{\ottcom{One way connection}}}

\newcommand{\ottwstmt}{
\ottrulehead{\mathcal{W}_{stmt}}{::=}{\ottcom{Statements inside wrap}}\ottprodnewline
\ottfirstprodline{|}{ \textbf{before} \  pexp_{w}  \ \textbf{do} \ \{  \ottnt{statement} ^+ \} }{}{}{}{}\ottprodnewline
\ottprodline{|}{ \textbf{after} \  pexp_{w}  \ \textbf{do} \ \{  \ottnt{statement} ^+ \} }{}{}{}{}}

\newcommand{\ottpexpXXw}{
\ottrulehead{pexp_{w}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\ottmv{A} \, \Vert \, \ottmv{env}}{}{}{}{}}

\newcommand{\ottpexp}{
\ottrulehead{\mathcal{P}_{exp}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\ottmv{env}}{}{}{}{\ottcom{environment}}\ottprodnewline
\ottprodline{|}{\ottmv{A} \, \Vert \, \ottmv{B}}{}{}{}{\ottcom{Two parties}}\ottprodnewline
\ottprodline{|}{\ottsym{s.A} \, \Vert \, \ottmv{env}}{}{}{}{\ottcom{env of Party of session}}\ottprodnewline
\ottprodline{|}{pexp_{w}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottmv{A}}{}{}{}{\ottcom{Party}}}

\newcommand{\ottexp}{
\ottrulehead{\ottnt{exp}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\ottnt{exp}  \ottsym{+}  \ottnt{exp'}}{}{}{}{\ottcom{Addition of two Int}}\ottprodnewline
\ottprodline{|}{\ottsym{A.x}}{}{}{}{\ottcom{Variable of a party A}}}

\newcommand{\ottTenv}{
\ottrulehead{T}{::=}{\ottcom{Type environment}}\ottprodnewline
\ottfirstprodline{|}{ \epsilon }{}{}{}{\ottcom{Empty}}\ottprodnewline
\ottprodline{|}{T  \ottsym{,} \, \ottkw{G} \, \ottsym{:}  \tau}{}{}{}{}}

\newcommand{\ottgrammar}{\ottgrammartabular{
\otttau\ottinterrule
\ottprogram\ottinterrule
\ottprtcl\ottinterrule
\ottconstant\ottinterrule
\ottstatement\ottinterrule
\ottwstmt\ottinterrule
\ottpexpXXw\ottinterrule
\ottpexp\ottinterrule
\ottexp\ottinterrule
\ottTenv\ottafterlastrule
}}

% defnss
% defns Jtype
%% defn Constant
\newcommand{\ottdruleConstantXXInt}[1]{\ottdrule[#1]{%
}{
T  \vdash  \ottsym{integer\_literal}  \ottsym{:}  \ottkw{Int}}{%
{\ottdrulename{Constant\_Int}}{}%
}}


\newcommand{\ottdruleConstantXXtrue}[1]{\ottdrule[#1]{%
}{
T  \vdash  \ottkw{true}  \ottsym{:}  \ottkw{Bool}}{%
{\ottdrulename{Constant\_true}}{}%
}}


\newcommand{\ottdruleConstantXXfalse}[1]{\ottdrule[#1]{%
}{
T  \vdash  \ottkw{false}  \ottsym{:}  \ottkw{Bool}}{%
{\ottdrulename{Constant\_false}}{}%
}}

\newcommand{\ottdefnConstant}[1]{\begin{ottdefnblock}[#1]{$T  \vdash  \ottnt{constant}  \ottsym{:}  \tau$}{}
\ottusedrule{\ottdruleConstantXXInt{}}
\ottusedrule{\ottdruleConstantXXtrue{}}
\ottusedrule{\ottdruleConstantXXfalse{}}
\end{ottdefnblock}}

%% defn Stmt
\newcommand{\ottdruleStmtXXpvt}[1]{\ottdrule[#1]{%
\ottpremise{\ottmv{A}  \ottsym{:}  \ottkw{Party} \, \in \, T}%
\ottpremise{T  \vdash  \ottnt{statement}  \ottsym{:}  \ottsym{()}}%
}{
\texttt{\textcolor{red}{<<no parses (char 11): 	Tenv , G \mbox{$\mid$}***- in A \{ statement \} : () >>}}}{%
{\ottdrulename{Stmt\_pvt}}{}%
}}


\newcommand{\ottdruleStmtXXdecl}[1]{\ottdrule[#1]{%
\ottpremise{\ottmv{x}  \ottsym{:}  \tau \, \notin \, T}%
}{
T  \vdash  \tau \, \ottmv{x}  \ottsym{;}  \ottsym{:}  \tau}{%
{\ottdrulename{Stmt\_decl}}{}%
}}


\newcommand{\ottdruleStmtXXfwd}[1]{\ottdrule[#1]{%
\ottpremise{T  \vdash  \ottmv{env}  \ottsym{:}  \ottsym{()}}%
\ottpremise{T  \vdash  \ottmv{x}  \ottsym{:}  \tau}%
}{
T  \vdash  \ottmv{env}  \Rightarrow  \ottmv{x}  \ottsym{;}  \ottsym{:}  \tau}{%
{\ottdrulename{Stmt\_fwd}}{}%
}}


\newcommand{\ottdruleStmtXXassignmnt}[1]{\ottdrule[#1]{%
\ottpremise{T  \vdash  \ottmv{x}  \ottsym{:}  \tau}%
\ottpremise{T  \vdash  \ottnt{exp}  \ottsym{:}  \tau}%
}{
T  \vdash  \ottmv{x}  \ottsym{=}  \ottnt{exp}  \ottsym{;}  \ottsym{:}  \tau}{%
{\ottdrulename{Stmt\_assignmnt}}{}%
}}


\newcommand{\ottdruleStmtXXopensession}[1]{\ottdrule[#1]{%
\ottpremise{T  \vdash  \ottmv{x}  \ottsym{:}  \tau}%
\ottpremise{T  \vdash  \ottmv{s}  \ottsym{:}  \ottkw{Session}}%
\ottpremise{T  \vdash  \wp  \ottsym{:}  \ottkw{Protocol}}%
\ottpremise{T  \vdash  \ottmv{A}  \ottsym{:}  \ottkw{Party}}%
\ottpremise{T  \vdash  \ottmv{B}  \ottsym{:}  \ottkw{Party}}%
}{
T  \vdash   \textbf{open} \  \ottmv{s}  \ \textbf{as }  \wp  (  \ottmv{x}  ) \ \{ \ ( \ottmv{A} : \ottmv{B} )^+ \ \}   \ottsym{:}  \ottsym{()}}{%
{\ottdrulename{Stmt\_opensession}}{}%
}}


\newcommand{\ottdruleStmtXXset}[1]{\ottdrule[#1]{%
\ottpremise{T  \vdash  \ottmv{A}  \ottsym{:}  \ottkw{Party}}%
\ottpremise{T  \vdash  \ottmv{B}  \ottsym{:}  \ottkw{Party}}%
\ottpremise{T  \vdash  \wp  \ottsym{:}  \ottkw{Protocol}}%
\ottpremise{T  \vdash  \ottmv{x}  \ottsym{:}  \tau}%
}{
T  \vdash   \textbf{set} \  \ottmv{A}  \ \textbf{as} \  \wp  (  \ottmv{x} ^* ) \ \textbf{::} \  \ottmv{B}   \ottsym{:}  \ottsym{()}}{%
{\ottdrulename{Stmt\_set}}{}%
}}


\newcommand{\ottdruleStmtXXfwdExprToExpr}[1]{\ottdrule[#1]{%
\ottpremise{T  \vdash  \ottnt{exp}  \ottsym{:}  \tau}%
\ottpremise{T  \vdash  \ottnt{exp'}  \ottsym{:}  \tau}%
}{
T  \vdash  \ottnt{exp}  \Rightarrow  \ottnt{exp'}  \ottsym{:}  \tau}{%
{\ottdrulename{Stmt\_fwdExprToExpr}}{}%
}}


\newcommand{\ottdruleStmtXXwrap}[1]{\ottdrule[#1]{%
}{
T  \vdash   \textbf{wrap} \ \{  \mathcal{W}_{stmt} ^+ \}   \ottsym{:}  \ottsym{()}}{%
{\ottdrulename{Stmt\_wrap}}{}%
}}


\newcommand{\ottdruleStmtXXconnectTo}[1]{\ottdrule[#1]{%
\ottpremise{T  \vdash  \mathcal{P}_{exp}  \ottsym{:}  \tau}%
\ottpremise{T  \vdash  \mathcal{P}_{exp}'  \ottsym{:}  \tau}%
}{
T  \vdash   \textbf{connect} \  \mathcal{P}_{exp}  \ \textbf{to} \  \mathcal{P}_{exp}'   \ottsym{:}  \tau}{%
{\ottdrulename{Stmt\_connectTo}}{}%
}}


\newcommand{\ottdruleStmtXXconnectAnd}[1]{\ottdrule[#1]{%
\ottpremise{T  \vdash  \mathcal{P}_{exp}  \ottsym{:}  \tau}%
\ottpremise{T  \vdash  \mathcal{P}_{exp}'  \ottsym{:}  \tau}%
}{
T  \vdash   \textbf{connect} \  \mathcal{P}_{exp}  \ \textbf{and} \  \mathcal{P}_{exp}'   \ottsym{:}  \tau}{%
{\ottdrulename{Stmt\_connectAnd}}{}%
}}

\newcommand{\ottdefnStmt}[1]{\begin{ottdefnblock}[#1]{$T  \vdash  \ottnt{stmt}  \ottsym{:}  \tau$}{}
\ottusedrule{\ottdruleStmtXXpvt{}}
\ottusedrule{\ottdruleStmtXXdecl{}}
\ottusedrule{\ottdruleStmtXXfwd{}}
\ottusedrule{\ottdruleStmtXXassignmnt{}}
\ottusedrule{\ottdruleStmtXXopensession{}}
\ottusedrule{\ottdruleStmtXXset{}}
\ottusedrule{\ottdruleStmtXXfwdExprToExpr{}}
\ottusedrule{\ottdruleStmtXXwrap{}}
\ottusedrule{\ottdruleStmtXXconnectTo{}}
\ottusedrule{\ottdruleStmtXXconnectAnd{}}
\end{ottdefnblock}}

%% defn Wrapstmt
\newcommand{\ottdruleWrapstmtXXbefore}[1]{\ottdrule[#1]{%
\ottpremise{T  \vdash  pexp_{w}  \ottsym{:}  \ottkw{Port}}%
\ottpremise{T  \vdash  \ottnt{statement}  \ottsym{:}  \tau}%
}{
T  \vdash   \textbf{before} \  pexp_{w}  \ \textbf{do} \ \{  \ottnt{statement} ^+ \}   \ottsym{:}  \tau}{%
{\ottdrulename{Wrapstmt\_before}}{}%
}}


\newcommand{\ottdruleWrapstmtXXafter}[1]{\ottdrule[#1]{%
\ottpremise{T  \vdash  pexp_{w}  \ottsym{:}  \ottkw{Port}}%
\ottpremise{T  \vdash  \ottnt{statement}  \ottsym{:}  \tau}%
}{
T  \vdash   \textbf{after} \  pexp_{w}  \ \textbf{do} \ \{  \ottnt{statement} ^+ \}   \ottsym{:}  \tau}{%
{\ottdrulename{Wrapstmt\_after}}{}%
}}

\newcommand{\ottdefnWrapstmt}[1]{\begin{ottdefnblock}[#1]{$T  \vdash  \mathcal{W}_{stmt}  \ottsym{:}  \tau$}{}
\ottusedrule{\ottdruleWrapstmtXXbefore{}}
\ottusedrule{\ottdruleWrapstmtXXafter{}}
\end{ottdefnblock}}

%% defn Protocol
\newcommand{\ottdruleProtocolXXdecl}[1]{\ottdrule[#1]{%
\ottpremise{T  \vdash  \wp  \ottsym{:}  \ottkw{Protocol}}%
\ottpremise{T  \vdash  \ottmv{x_{{\mathrm{1}}}}  \ottsym{:}  \tau_{{\mathrm{1}}}}%
\ottpremise{T  \vdash  \ottmv{x_{{\mathrm{2}}}}  \ottsym{:}  \tau_{{\mathrm{2}}}}%
\ottpremise{T  \vdash  \ottmv{x_{{\mathrm{3}}}}  \ottsym{:}  \tau_{{\mathrm{3}}}}%
\ottpremise{T  \vdash  \ottmv{A}  \ottsym{:}  \ottkw{Party}}%
\ottpremise{T  \vdash  \ottnt{statement}  \ottsym{:}  \tau}%
}{
T  \vdash   \textbf{protocol} \  \wp  ( ( \tau  \  \ottmv{x} )^{+} ) \ \textbf{: party }  \ottmv{A} ^+
	    \{ \  \ottnt{statement} ^+ \ \}   \ottsym{:}  \tau}{%
{\ottdrulename{Protocol\_decl}}{}%
}}

\newcommand{\ottdefnProtocol}[1]{\begin{ottdefnblock}[#1]{$T  \vdash  \ottnt{prtcl}  \ottsym{:}  \tau$}{}
\ottusedrule{\ottdruleProtocolXXdecl{}}
\end{ottdefnblock}}

%% defn Exp
\newcommand{\ottdruleExpXXAddition}[1]{\ottdrule[#1]{%
\ottpremise{T  \vdash  \ottnt{exp}  \ottsym{:}  \ottkw{Int}}%
\ottpremise{T  \vdash  \ottnt{exp'}  \ottsym{:}  \ottkw{Int}}%
}{
T  \vdash  \ottnt{exp}  \ottsym{+}  \ottnt{exp'}  \ottsym{:}  \ottkw{Int}}{%
{\ottdrulename{Exp\_Addition}}{}%
}}


\newcommand{\ottdruleExpXXPartyVar}[1]{\ottdrule[#1]{%
\ottpremise{\ottmv{x}  \ottsym{:}  \tau \, \in \, T}%
\ottpremise{T  \vdash  \ottmv{A}  \ottsym{:}  \ottkw{Party}}%
}{
T  \vdash  \ottsym{A.x}  \ottsym{:}  \tau}{%
{\ottdrulename{Exp\_PartyVar}}{}%
}}

\newcommand{\ottdefnExp}[1]{\begin{ottdefnblock}[#1]{$T  \vdash  \ottnt{exp}  \ottsym{:}  \tau$}{}
\ottusedrule{\ottdruleExpXXAddition{}}
\ottusedrule{\ottdruleExpXXPartyVar{}}
\end{ottdefnblock}}


\newcommand{\ottdefnsJtype}{
\ottdefnConstant{}\ottdefnStmt{}\ottdefnWrapstmt{}\ottdefnProtocol{}\ottdefnExp{}}

% defns Jop

\newcommand{\ottdefnsJop}{
}

\newcommand{\ottdefnss}{
\ottdefnsJtype
\ottdefnsJop
}

\newcommand{\ottall}{\ottmetavars\\[0pt]
\ottgrammar\\[5.0mm]
\ottdefnss}

\begin{document}
\ottall

\begin{verbatim}
Definition rules:        17 good    1 bad
Definition rule clauses: 53 good    1 bad
\end{verbatim}
\end{document}
