% generated by Ott 0.25 from: grammar.ott
\documentclass[11pt]{article}
\usepackage{amsmath,amssymb}
\usepackage{supertabular}
\usepackage{geometry}
\usepackage{ifthen}
\usepackage{alltt}%hack
\geometry{a4paper,dvips,twoside,left=22.5mm,right=22.5mm,top=20mm,bottom=30mm}
\usepackage{color}
\newcommand{\ottdrule}[4][]{{\displaystyle\frac{\begin{array}{l}#2\end{array}}{#3}\quad\ottdrulename{#4}}}
\newcommand{\ottusedrule}[1]{\[#1\]}
\newcommand{\ottpremise}[1]{ #1 \\}
\newenvironment{ottdefnblock}[3][]{ \framebox{\mbox{#2}} \quad #3 \\[0pt]}{}
\newenvironment{ottfundefnblock}[3][]{ \framebox{\mbox{#2}} \quad #3 \\[0pt]\begin{displaymath}\begin{array}{l}}{\end{array}\end{displaymath}}
\newcommand{\ottfunclause}[2]{ #1 \equiv #2 \\}
\newcommand{\ottnt}[1]{\mathit{#1}}
\newcommand{\ottmv}[1]{\mathit{#1}}
\newcommand{\ottkw}[1]{\mathbf{#1}}
\newcommand{\ottsym}[1]{#1}
\newcommand{\ottcom}[1]{\text{#1}}
\newcommand{\ottdrulename}[1]{\textsc{#1}}
\newcommand{\ottcomplu}[5]{\overline{#1}^{\,#2\in #3 #4 #5}}
\newcommand{\ottcompu}[3]{\overline{#1}^{\,#2<#3}}
\newcommand{\ottcomp}[2]{\overline{#1}^{\,#2}}
\newcommand{\ottgrammartabular}[1]{\begin{supertabular}{llcllllll}#1\end{supertabular}}
\newcommand{\ottmetavartabular}[1]{\begin{supertabular}{ll}#1\end{supertabular}}
\newcommand{\ottrulehead}[3]{$#1$ & & $#2$ & & & \multicolumn{2}{l}{#3}}
\newcommand{\ottprodline}[6]{& & $#1$ & $#2$ & $#3 #4$ & $#5$ & $#6$}
\newcommand{\ottfirstprodline}[6]{\ottprodline{#1}{#2}{#3}{#4}{#5}{#6}}
\newcommand{\ottlongprodline}[2]{& & $#1$ & \multicolumn{4}{l}{$#2$}}
\newcommand{\ottfirstlongprodline}[2]{\ottlongprodline{#1}{#2}}
\newcommand{\ottbindspecprodline}[6]{\ottprodline{#1}{#2}{#3}{#4}{#5}{#6}}
\newcommand{\ottprodnewline}{\\}
\newcommand{\ottinterrule}{\\[5.0mm]}
\newcommand{\ottafterlastrule}{\\}
\newcommand{\ottmetavars}{
\ottmetavartabular{
 $ \ottmv{A} ,\, \ottmv{B} $ & \ottcom{Names of parties A , B} \\
 $ \ottmv{P} $ & \ottcom{Protocol name $\ottmv{P}$} \\
 $ \ottmv{x} ,\, \ottmv{y} ,\, \ottmv{s} $ & \ottcom{Variables Eg. Session, Party,  Integer variables.} \\
 $ \ottmv{env} $ & \ottcom{Special environment variable $\ottmv{env}$} \\
 $ \ottmv{O} $ & \ottcom{Port name $\ottmv{O}$} \\
 $ \ottmv{G} $ &  \\
 $ \mathcal{M} $ &  \\
 $ \rho $ &  \\
 $ \ottmv{S} $ &  \\
 $ \ottmv{n} ,\, \ottmv{m} ,\, \ottmv{k} $ & \ottcom{Index variables} \\
}}

\newcommand{\otttau}{
\ottrulehead{\tau}{::=}{\ottcom{Types}}\ottprodnewline
\ottfirstprodline{|}{\ottkw{Party}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottkw{Int}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottkw{Bool}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottkw{Session}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottkw{Port}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottkw{Field}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottkw{Protocol}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottsym{()}}{}{}{}{\ottcom{Well typed}}}

\newcommand{\ottconstant}{
\ottrulehead{\ottnt{constant}  ,\ \ottnt{c}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\ottsym{integer\_literal}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottkw{true}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottkw{false}}{}{}{}{}}

\newcommand{\ottprogram}{
\ottrulehead{\ottnt{program}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{ \ottnt{prtcl} ^+ }{}{}{}{\ottcom{One or more protocols}}}

\newcommand{\ottprtcl}{
\ottrulehead{\ottnt{prtcl}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\ottkw{protocol} \, \ottmv{P}  \ottsym{(}  \tau_{{\mathrm{1}}} \, \ottmv{x_{{\mathrm{1}}}}  \ottsym{,} \, .. \, \ottsym{,}  \tau_{\ottmv{n}} \, \ottmv{x_{\ottmv{n}}}  \ottsym{)}  \ottsym{:} \, \ottkw{party} \, \ottmv{A_{{\mathrm{1}}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottmv{A_{\ottmv{m}}}  \ottsym{\{}  \ottnt{stmt_{{\mathrm{1}}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottnt{stmt_{\ottmv{k}}}  \ottsym{\}}}{}{}{}{}}

\newcommand{\ottstatement}{
\ottrulehead{\ottnt{statement}  ,\ \ottnt{stmt}}{::=}{\ottcom{Statements}}\ottprodnewline
\ottfirstprodline{|}{ \textbf{in }  \ottmv{A}  \ \{ \  \ottnt{statement} ^+ \ \} }{}{}{}{\ottcom{Private statement}}\ottprodnewline
\ottprodline{|}{\tau \, \ottmv{x}  \ottsym{;}}{}{}{}{\ottcom{Declare a variable}}\ottprodnewline
\ottprodline{|}{\ottsym{statement;}  \ottsym{statement';}}{}{}{}{\ottcom{Sequence}}\ottprodnewline
\ottprodline{|}{\ottmv{env}  \Rightarrow  \ottmv{x}  \ottsym{;}}{}{}{}{\ottcom{Send from env to var}}\ottprodnewline
\ottprodline{|}{\ottmv{x}  \Rightarrow  \ottmv{env}  \ottsym{;}}{}{}{}{\ottcom{Send from var to env}}\ottprodnewline
\ottprodline{|}{\ottnt{exp}  \Rightarrow  \ottnt{exp'}}{}{}{}{\ottcom{Send from a exp to exp}}\ottprodnewline
\ottprodline{|}{\ottmv{x}  \ottsym{=}  \ottnt{exp}  \ottsym{;}}{}{}{}{\ottcom{Assignment}}\ottprodnewline
\ottprodline{|}{\ottkw{open} \, \ottmv{s} \, \ottkw{as} \, \ottmv{P}  \ottsym{(}  \ottmv{x_{{\mathrm{1}}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottmv{x_{\ottmv{n}}}  \ottsym{)}  \ottsym{\{}  \ottmv{A_{{\mathrm{1}}}}  \ottsym{:}  \ottmv{B_{{\mathrm{1}}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottmv{A_{\ottmv{m}}}  \ottsym{:}  \ottmv{B_{\ottmv{m}}}  \ottsym{\}}}{}{}{}{\ottcom{Open session $\ottmv{s}$}}\ottprodnewline
\ottprodline{|}{\ottkw{set} \, \ottmv{A} \, \ottkw{as} \, \ottmv{P}  \ottsym{(}  \ottmv{x_{{\mathrm{1}}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottmv{x_{\ottmv{n}}}  \ottsym{)::B}}{}{}{}{\ottcom{Set party as another party of another protocol}}\ottprodnewline
\ottprodline{|}{ \textbf{wrap} \ \{  \mathcal{W}_{stmt} ^+ \} }{}{}{}{\ottcom{Wrap statement}}\ottprodnewline
\ottprodline{|}{ \textbf{connect} \  \mathcal{P}_{exp}  \ \textbf{and} \  \mathcal{P}_{exp}' }{}{}{}{\ottcom{Duplex connection}}\ottprodnewline
\ottprodline{|}{ \textbf{connect} \  \mathcal{P}_{exp}  \ \textbf{to} \  \mathcal{P}_{exp}' }{}{}{}{\ottcom{One way connection}}}

\newcommand{\ottwstmt}{
\ottrulehead{\mathcal{W}_{stmt}}{::=}{\ottcom{Statements inside wrap}}\ottprodnewline
\ottfirstprodline{|}{\ottkw{before} \, \mathcal{P}_{exp} \, \ottkw{do} \, \ottsym{\{}  \ottnt{statement_{{\mathrm{1}}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottnt{statement_{\ottmv{n}}}  \ottsym{\}}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottkw{after} \, \mathcal{P}_{exp} \, \ottkw{do} \, \ottsym{\{}  \ottnt{statement_{{\mathrm{1}}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottnt{statement_{\ottmv{n}}}  \ottsym{\}}}{}{}{}{}}

\newcommand{\ottpexp}{
\ottrulehead{\mathcal{P}_{exp}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\ottmv{A} \, \Vert \, \ottmv{env}}{}{}{}{\ottcom{environment}}\ottprodnewline
\ottprodline{|}{\ottmv{A} \, \Vert \, \ottmv{B}}{}{}{}{\ottcom{Two parties}}\ottprodnewline
\ottprodline{|}{\ottnt{exp} \, \Vert \, \ottmv{env}}{}{}{}{\ottcom{env of Party of session}}}

\newcommand{\ottexp}{
\ottrulehead{\ottnt{exp}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\ottnt{exp}  \ottsym{+}  \ottnt{exp'}}{}{}{}{\ottcom{Addition of two Int}}\ottprodnewline
\ottprodline{|}{\ottmv{A}  \ottsym{.}  \ottmv{x}}{}{}{}{\ottcom{Variable $\ottmv{x}$ of a party $\ottmv{A}$}}\ottprodnewline
\ottprodline{|}{\ottmv{s}  \ottsym{.}  \ottmv{A}}{}{}{}{\ottcom{Party $\ottmv{A}$ of a variable $\ottmv{s}$}}\ottprodnewline
\ottprodline{|}{\ottmv{x}}{}{}{}{\ottcom{Expression statement}}}

\newcommand{\ottscope}{
\ottrulehead{\ottnt{scope}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{ \mathcal{C} }{}{}{}{\ottcom{Current Scope}}\ottprodnewline
\ottprodline{|}{\ottsym{\_}}{}{}{}{\ottcom{Do not care}}\ottprodnewline
\ottprodline{|}{ \mathcal{G} }{}{}{}{\ottcom{Global Scope}}}

\newcommand{\ottTenv}{
\ottrulehead{\mathcal{E}}{::=}{\ottcom{Type environment}}\ottprodnewline
\ottfirstprodline{|}{ \epsilon }{}{}{}{\ottcom{Empty}}\ottprodnewline
\ottprodline{|}{\ottmv{G}  \ottsym{(}  \mathcal{E}  \ottsym{)}  \ottsym{=}  \ottsym{(}  \tau  \ottsym{,}  \ottnt{scope}  \ottsym{)}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\mathcal{M}  \ottsym{(}  \ottmv{P}  \ottsym{)}  \ottsym{=}  \ottsym{(}  \ottnt{argsig}  \ottsym{,}  \ottsym{\{}  \ottmv{A_{{\mathrm{1}}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottmv{A_{\ottmv{m}}}  \ottsym{\}}  \ottsym{)}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\rho  \ottsym{(}  \ottmv{P}  \ottsym{,}  \ottmv{A}  \ottsym{)}  \ottsym{=}  \ottsym{\{}  \ottmv{O_{{\mathrm{1}}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottmv{O_{\ottmv{n}}}  \ottsym{\}}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottmv{S}  \ottsym{(}  \ottmv{s}  \ottsym{)}  \ottsym{=}  \ottmv{P}}{}{}{}{\ottcom{Open as protocol $\ottmv{P}$}}\ottprodnewline
\ottprodline{|}{\mathcal{E}  \ottsym{,}  \mathcal{E}'}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottmv{G}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\mathcal{M}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\rho}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottmv{S}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{scope}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottmv{A}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottmv{x}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottmv{P}}{}{}{}{}}

\newcommand{\ottargsig}{
\ottrulehead{\ottnt{argsig}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\ottsym{\{}  \tau_{{\mathrm{1}}}  \ottsym{,} \, .. \, \ottsym{,}  \tau_{\ottmv{n}}  \ottsym{\}}}{}{}{}{}}

\newcommand{\ottgrammar}{\ottgrammartabular{
\otttau\ottinterrule
\ottconstant\ottinterrule
\ottprogram\ottinterrule
\ottprtcl\ottinterrule
\ottstatement\ottinterrule
\ottwstmt\ottinterrule
\ottpexp\ottinterrule
\ottexp\ottinterrule
\ottscope\ottinterrule
\ottTenv\ottinterrule
\ottargsig\ottafterlastrule
}}

% defnss
% defns Jtype
%% defn Constant
\newcommand{\ottdruleConstantXXInt}[1]{\ottdrule[#1]{%
}{
\ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C}   \vdash  \ottsym{integer\_literal}  \ottsym{:}  \ottkw{Int}}{%
{\ottdrulename{Constant\_Int}}{}%
}}


\newcommand{\ottdruleConstantXXtrue}[1]{\ottdrule[#1]{%
}{
\ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C}   \vdash  \ottkw{true}  \ottsym{:}  \ottkw{Bool}}{%
{\ottdrulename{Constant\_true}}{}%
}}


\newcommand{\ottdruleConstantXXfalse}[1]{\ottdrule[#1]{%
}{
\ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C}   \vdash  \ottkw{false}  \ottsym{:}  \ottkw{Bool}}{%
{\ottdrulename{Constant\_false}}{}%
}}

\newcommand{\ottdefnConstant}[1]{\begin{ottdefnblock}[#1]{$\mathcal{E}  \vdash  \ottnt{constant}  \ottsym{:}  \tau$}{}
\ottusedrule{\ottdruleConstantXXInt{}}
\ottusedrule{\ottdruleConstantXXtrue{}}
\ottusedrule{\ottdruleConstantXXfalse{}}
\end{ottdefnblock}}

%% defn Stmt
\newcommand{\ottdruleStmtXXdecl}[1]{\ottdrule[#1]{%
\ottpremise{\ottmv{x} \, \notin \,  \mathcal{C} }%
\ottpremise{\ottmv{G}  \ottsym{(}  \ottmv{x}  \ottsym{)}  \ottsym{=}  \ottsym{(}  \tau  \ottsym{,}   \mathcal{C}   \ottsym{)}}%
}{
\ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C}   \vdash  \tau \, \ottmv{x}  \ottsym{;}  \ottsym{:}  \tau  \ottsym{,}  \ottmv{G'}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C} }{%
{\ottdrulename{Stmt\_decl}}{}%
}}


\newcommand{\ottdruleStmtXXseq}[1]{\ottdrule[#1]{%
\ottpremise{\ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C}   \vdash  \ottnt{statement}  \ottsym{:}  \tau}%
\ottpremise{\ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C}   \vdash  \ottnt{statement'}  \ottsym{:}  \tau'}%
}{
\ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C}   \vdash  \ottsym{statement;}  \ottsym{statement';}  \ottsym{:}  \tau'  \ottsym{,}  \ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C} }{%
{\ottdrulename{Stmt\_seq}}{}%
}}


\newcommand{\ottdruleStmtXXpvt}[1]{\ottdrule[#1]{%
\ottpremise{\ottmv{G}  \ottsym{(}  \ottmv{A}  \ottsym{)}  \ottsym{=}  \ottsym{(}  \ottkw{Party}  \ottsym{,}  \ottsym{\_}  \ottsym{)}}%
\ottpremise{\ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}  \ottmv{A}  \vdash  \ottnt{statement}  \ottsym{:}  \ottsym{()}}%
}{
\ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C}   \vdash   \textbf{in }  \ottmv{A}  \ \{ \  \ottnt{statement} ^+ \ \}   \ottsym{:}  \ottsym{()}  \ottsym{,}  \ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C} }{%
{\ottdrulename{Stmt\_pvt}}{}%
}}


\newcommand{\ottdruleStmtXXsendEnvToVar}[1]{\ottdrule[#1]{%
\ottpremise{\ottmv{G}  \ottsym{(}  \ottmv{x}  \ottsym{)}  \ottsym{=}  \ottsym{(}  \ottkw{Int}  \ottsym{,}   \mathcal{C}   \ottsym{)}}%
}{
\ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C}   \vdash  \ottmv{env}  \Rightarrow  \ottmv{x}  \ottsym{;}  \ottsym{:}  \ottsym{()}  \ottsym{,}  \ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C} }{%
{\ottdrulename{Stmt\_sendEnvToVar}}{}%
}}


\newcommand{\ottdruleStmtXXsendVarToEnv}[1]{\ottdrule[#1]{%
\ottpremise{\ottmv{G}  \ottsym{(}  \ottmv{x}  \ottsym{)}  \ottsym{=}  \ottsym{(}  \ottkw{Int}  \ottsym{,}   \mathcal{C}   \ottsym{)}}%
}{
\ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C}   \vdash  \ottmv{x}  \Rightarrow  \ottmv{env}  \ottsym{;}  \ottsym{:}  \ottsym{()}  \ottsym{,}  \ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C} }{%
{\ottdrulename{Stmt\_sendVarToEnv}}{}%
}}


\newcommand{\ottdruleStmtXXsendExprToExpr}[1]{\ottdrule[#1]{%
\ottpremise{\ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C}   \vdash  \ottnt{exp}  \ottsym{:}  \tau}%
\ottpremise{\ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C}   \vdash  \ottnt{exp'}  \ottsym{:}  \tau'}%
\ottpremise{\tau \, \in \, \ottsym{\{}  \ottkw{Port}  \ottsym{,}  \ottkw{Int}  \ottsym{\}}}%
\ottpremise{\tau' \, \in \, \ottsym{\{}  \ottkw{Port}  \ottsym{,}  \ottkw{Int}  \ottsym{\}}}%
}{
\ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C}   \vdash  \ottnt{exp}  \Rightarrow  \ottnt{exp'}  \ottsym{:}  \ottsym{()}  \ottsym{,}  \ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C} }{%
{\ottdrulename{Stmt\_sendExprToExpr}}{}%
}}


\newcommand{\ottdruleStmtXXassignmnt}[1]{\ottdrule[#1]{%
\ottpremise{\ottmv{G}  \ottsym{(}  \ottmv{x}  \ottsym{)}  \ottsym{=}  \ottsym{(}  \tau  \ottsym{,}   \mathcal{C}   \ottsym{)}}%
\ottpremise{\ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C}   \vdash  \ottnt{exp}  \ottsym{:}  \tau}%
}{
\ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C}   \vdash  \ottmv{x}  \ottsym{=}  \ottnt{exp}  \ottsym{;}  \ottsym{:}  \tau  \ottsym{,}  \ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C} }{%
{\ottdrulename{Stmt\_assignmnt}}{}%
}}


\newcommand{\ottdruleStmtXXopensession}[1]{\ottdrule[#1]{%
\ottpremise{\ottmv{G}  \ottsym{(}  \ottmv{s}  \ottsym{)}  \ottsym{=}  \ottsym{(}  \ottkw{Session}  \ottsym{,}   \mathcal{C}   \ottsym{)}}%
\ottpremise{\ottmv{G}  \ottsym{(}  \ottmv{P}  \ottsym{)}  \ottsym{=}  \ottsym{(}  \ottkw{Protocol}  \ottsym{,}  \ottsym{\_}  \ottsym{)}}%
\ottpremise{\mathcal{M}  \ottsym{(}  \ottmv{P}  \ottsym{)}  \ottsym{=}  \ottsym{(}  \ottnt{argsig}  \ottsym{,}  \ottsym{\{}  \ottmv{A_{{\mathrm{1}}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottmv{A_{\ottmv{m}}}  \ottsym{\}}  \ottsym{)}}%
\ottpremise{\ottmv{G}  \ottsym{(}  \ottmv{x_{{\mathrm{1}}}}  \ottsym{)}  \ottsym{=}  \ottsym{(}  \tau_{{\mathrm{1}}}  \ottsym{,}   \mathcal{C}   \ottsym{)}}%
\ottpremise{\ottmv{G}  \ottsym{(}  \ottmv{x_{\ottmv{n}}}  \ottsym{)}  \ottsym{=}  \ottsym{(}  \tau_{\ottmv{n}}  \ottsym{,}   \mathcal{C}   \ottsym{)}}%
\ottpremise{\ottsym{[}  \tau_{{\mathrm{1}}}  \ottsym{,} \, .. \, \ottsym{,}  \tau_{\ottmv{n}}  \ottsym{]}  \ottsym{=}  \ottnt{argsig}}%
\ottpremise{\ottmv{G}  \ottsym{(}  \ottmv{B_{{\mathrm{1}}}}  \ottsym{)}  \ottsym{=}  \ottsym{(}  \ottkw{Party}  \ottsym{,}   \mathcal{C}   \ottsym{)}}%
\ottpremise{\ottmv{G}  \ottsym{(}  \ottmv{B_{\ottmv{m}}}  \ottsym{)}  \ottsym{=}  \ottsym{(}  \ottkw{Party}  \ottsym{,}   \mathcal{C}   \ottsym{)}}%
\ottpremise{\ottmv{A_{{\mathrm{1}}}}  \ottsym{=}  \ottmv{B_{{\mathrm{1}}}}}%
\ottpremise{\ottmv{A_{\ottmv{m}}}  \ottsym{=}  \ottmv{B_{\ottmv{m}}}}%
\ottpremise{\ottmv{S}  \ottsym{=}  \ottmv{S'}}%
\ottpremise{\ottmv{S'}  \ottsym{(}  \ottmv{s}  \ottsym{)}  \ottsym{=}  \ottmv{P}}%
}{
\ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C}   \vdash  \ottkw{open} \, \ottmv{s} \, \ottkw{as} \, \ottmv{P}  \ottsym{(}  \ottmv{x_{{\mathrm{1}}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottmv{x_{\ottmv{n}}}  \ottsym{)}  \ottsym{\{}  \ottmv{A_{{\mathrm{1}}}}  \ottsym{:}  \ottmv{B_{{\mathrm{1}}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottmv{A_{\ottmv{m}}}  \ottsym{:}  \ottmv{B_{\ottmv{m}}}  \ottsym{\}}  \ottsym{:}  \ottsym{()}  \ottsym{,}  \ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S'}  \ottsym{,}   \mathcal{C} }{%
{\ottdrulename{Stmt\_opensession}}{}%
}}


\newcommand{\ottdruleStmtXXset}[1]{\ottdrule[#1]{%
\ottpremise{\ottmv{G}  \ottsym{(}  \ottmv{A}  \ottsym{)}  \ottsym{=}  \ottsym{(}  \ottkw{Party}  \ottsym{,}   \mathcal{C}   \ottsym{)}}%
\ottpremise{\ottmv{G}  \ottsym{(}  \ottmv{P}  \ottsym{)}  \ottsym{=}  \ottsym{(}  \ottkw{Protocol}  \ottsym{,}  \ottsym{\_}  \ottsym{)}}%
\ottpremise{\ottmv{G}  \ottsym{(}  \ottmv{x_{{\mathrm{1}}}}  \ottsym{)}  \ottsym{=}  \ottsym{(}  \tau_{{\mathrm{1}}}  \ottsym{,}   \mathcal{C}   \ottsym{)}}%
\ottpremise{\ottmv{G}  \ottsym{(}  \ottmv{x_{\ottmv{n}}}  \ottsym{)}  \ottsym{=}  \ottsym{(}  \tau_{\ottmv{n}}  \ottsym{,}   \mathcal{C}   \ottsym{)}}%
\ottpremise{\mathcal{M}  \ottsym{(}  \ottmv{P}  \ottsym{)}  \ottsym{=}  \ottsym{(}  \ottnt{argsig}  \ottsym{,}  \ottsym{\{}  \ottmv{A_{{\mathrm{1}}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottmv{A_{\ottmv{m}}}  \ottsym{\}}  \ottsym{)}}%
\ottpremise{\ottmv{B} \, \in \, \ottsym{\{}  \ottmv{A_{{\mathrm{1}}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottmv{A_{\ottmv{m}}}  \ottsym{\}}}%
\ottpremise{\ottsym{[}  \tau_{{\mathrm{1}}}  \ottsym{,} \, .. \, \ottsym{,}  \tau_{\ottmv{n}}  \ottsym{]}  \ottsym{=}  \ottnt{argsig}}%
}{
 \mathcal{C}   \vdash  \ottkw{set} \, \ottmv{A} \, \ottkw{as} \, \ottmv{P}  \ottsym{(}  \ottmv{x_{{\mathrm{1}}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottmv{x_{\ottmv{n}}}  \ottsym{)::B}  \ottsym{:}  \ottsym{()}  \ottsym{,}  \ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C} }{%
{\ottdrulename{Stmt\_set}}{}%
}}


\newcommand{\ottdruleStmtXXwrap}[1]{\ottdrule[#1]{%
\ottpremise{\ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C}   \vdash  \mathcal{W}_{stmt}  \ottsym{:}  \ottsym{()}}%
}{
\ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C}   \vdash   \textbf{wrap} \ \{  \mathcal{W}_{stmt} ^+ \}   \ottsym{:}  \ottsym{()}  \ottsym{,}  \ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C} }{%
{\ottdrulename{Stmt\_wrap}}{}%
}}


\newcommand{\ottdruleStmtXXconnectTo}[1]{\ottdrule[#1]{%
\ottpremise{\ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C}   \vdash  \mathcal{P}_{exp}  \ottsym{:}  \ottkw{Port}}%
\ottpremise{\ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C}   \vdash  \mathcal{P}_{exp}'  \ottsym{:}  \ottkw{Port}}%
}{
\ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C}   \vdash   \textbf{connect} \  \mathcal{P}_{exp}  \ \textbf{to} \  \mathcal{P}_{exp}'   \ottsym{:}  \ottsym{()}  \ottsym{,}  \ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C} }{%
{\ottdrulename{Stmt\_connectTo}}{}%
}}


\newcommand{\ottdruleStmtXXconnectAnd}[1]{\ottdrule[#1]{%
\ottpremise{\ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C}   \vdash  \mathcal{P}_{exp}  \ottsym{:}  \ottkw{Port}}%
\ottpremise{\ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C}   \vdash  \mathcal{P}_{exp}'  \ottsym{:}  \ottkw{Port}}%
}{
\ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C}   \vdash   \textbf{connect} \  \mathcal{P}_{exp}  \ \textbf{and} \  \mathcal{P}_{exp}'   \ottsym{:}  \ottsym{()}  \ottsym{,}  \ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C} }{%
{\ottdrulename{Stmt\_connectAnd}}{}%
}}

\newcommand{\ottdefnStmt}[1]{\begin{ottdefnblock}[#1]{$\mathcal{E}  \vdash  \ottnt{stmt}  \ottsym{:}  \tau  \ottsym{,}  \mathcal{E}'$}{}
\ottusedrule{\ottdruleStmtXXdecl{}}
\ottusedrule{\ottdruleStmtXXseq{}}
\ottusedrule{\ottdruleStmtXXpvt{}}
\ottusedrule{\ottdruleStmtXXsendEnvToVar{}}
\ottusedrule{\ottdruleStmtXXsendVarToEnv{}}
\ottusedrule{\ottdruleStmtXXsendExprToExpr{}}
\ottusedrule{\ottdruleStmtXXassignmnt{}}
\ottusedrule{\ottdruleStmtXXopensession{}}
\ottusedrule{\ottdruleStmtXXset{}}
\ottusedrule{\ottdruleStmtXXwrap{}}
\ottusedrule{\ottdruleStmtXXconnectTo{}}
\ottusedrule{\ottdruleStmtXXconnectAnd{}}
\end{ottdefnblock}}

%% defn Wrapstmt
\newcommand{\ottdruleWrapstmtXXbefore}[1]{\ottdrule[#1]{%
\ottpremise{\ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C}   \vdash  \mathcal{P}_{exp}  \ottsym{:}  \ottkw{Port}}%
\ottpremise{\ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C}   \vdash  \ottnt{statement_{{\mathrm{1}}}}  \ottsym{:}  \ottsym{()}}%
\ottpremise{\ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C}   \vdash  \ottnt{statement_{\ottmv{n}}}  \ottsym{:}  \ottsym{()}}%
}{
\ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C}   \vdash  \ottkw{before} \, \mathcal{P}_{exp} \, \ottkw{do} \, \ottsym{\{}  \ottnt{statement_{{\mathrm{1}}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottnt{statement_{\ottmv{n}}}  \ottsym{\}}  \ottsym{:}  \ottsym{()}}{%
{\ottdrulename{Wrapstmt\_before}}{}%
}}


\newcommand{\ottdruleWrapstmtXXafter}[1]{\ottdrule[#1]{%
\ottpremise{\ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C}   \vdash  \mathcal{P}_{exp}  \ottsym{:}  \ottkw{Port}}%
\ottpremise{\ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C}   \vdash  \ottnt{statement_{{\mathrm{1}}}}  \ottsym{:}  \ottsym{()}}%
\ottpremise{\ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C}   \vdash  \ottnt{statement_{\ottmv{n}}}  \ottsym{:}  \ottsym{()}}%
}{
\ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C}   \vdash  \ottkw{after} \, \mathcal{P}_{exp} \, \ottkw{do} \, \ottsym{\{}  \ottnt{statement_{{\mathrm{1}}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottnt{statement_{\ottmv{n}}}  \ottsym{\}}  \ottsym{:}  \ottsym{()}}{%
{\ottdrulename{Wrapstmt\_after}}{}%
}}

\newcommand{\ottdefnWrapstmt}[1]{\begin{ottdefnblock}[#1]{$\mathcal{E}  \vdash  \mathcal{W}_{stmt}  \ottsym{:}  \tau$}{}
\ottusedrule{\ottdruleWrapstmtXXbefore{}}
\ottusedrule{\ottdruleWrapstmtXXafter{}}
\end{ottdefnblock}}

%% defn Protocol
\newcommand{\ottdrulePrtclXXdecl}[1]{\ottdrule[#1]{%
\ottpremise{\ottmv{P} \, \notin \,  \mathcal{G} }%
\ottpremise{\ottmv{G}  \ottsym{(}  \ottmv{P}  \ottsym{)}  \ottsym{=}  \ottsym{(}  \ottkw{Protocol}  \ottsym{,}   \mathcal{G}   \ottsym{)}}%
\ottpremise{\ottmv{G}  \ottsym{(}  \ottmv{x_{{\mathrm{1}}}}  \ottsym{)}  \ottsym{=}  \ottsym{(}  \tau_{{\mathrm{1}}}  \ottsym{,}   \mathcal{C}   \ottsym{)}}%
\ottpremise{\ottmv{G}  \ottsym{(}  \ottmv{x_{\ottmv{n}}}  \ottsym{)}  \ottsym{=}  \ottsym{(}  \tau_{\ottmv{n}}  \ottsym{,}   \mathcal{C}   \ottsym{)}}%
\ottpremise{\ottmv{G}  \ottsym{(}  \ottmv{A_{{\mathrm{1}}}}  \ottsym{)}  \ottsym{=}  \ottsym{(}  \ottkw{Party}  \ottsym{,}   \mathcal{C}   \ottsym{)}}%
\ottpremise{\ottmv{G}  \ottsym{(}  \ottmv{A_{\ottmv{m}}}  \ottsym{)}  \ottsym{=}  \ottsym{(}  \ottkw{Party}  \ottsym{,}   \mathcal{C}   \ottsym{)}}%
\ottpremise{\ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}  \ottmv{P}  \vdash  \ottnt{stmt_{{\mathrm{1}}}}  \ottsym{:}  \ottsym{()}}%
\ottpremise{\ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}  \ottmv{P}  \vdash  \ottnt{stmt_{\ottmv{k}}}  \ottsym{:}  \ottsym{()}}%
}{
\ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{G}   \vdash  \ottkw{protocol} \, \ottmv{P}  \ottsym{(}  \tau_{{\mathrm{1}}} \, \ottmv{x_{{\mathrm{1}}}}  \ottsym{,} \, .. \, \ottsym{,}  \tau_{\ottmv{n}} \, \ottmv{x_{\ottmv{n}}}  \ottsym{)}  \ottsym{:} \, \ottkw{party} \, \ottmv{A_{{\mathrm{1}}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottmv{A_{\ottmv{m}}}  \ottsym{\{}  \ottnt{stmt_{{\mathrm{1}}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottnt{stmt_{\ottmv{k}}}  \ottsym{\}}  \ottsym{:}  \ottsym{()}  \ottsym{,}  \ottmv{G'}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{G} }{%
{\ottdrulename{Prtcl\_decl}}{}%
}}

\newcommand{\ottdefnProtocol}[1]{\begin{ottdefnblock}[#1]{$\mathcal{E}  \vdash  \ottnt{prtcl}  \ottsym{:}  \tau  \ottsym{,}  \mathcal{E}'$}{}
\ottusedrule{\ottdrulePrtclXXdecl{}}
\end{ottdefnblock}}

%% defn Exp
\newcommand{\ottdruleExpXXAddition}[1]{\ottdrule[#1]{%
\ottpremise{\ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C}   \vdash  \ottnt{exp}  \ottsym{:}  \tau}%
\ottpremise{\ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C}   \vdash  \ottnt{exp'}  \ottsym{:}  \tau}%
}{
\ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C}   \vdash  \ottnt{exp}  \ottsym{+}  \ottnt{exp'}  \ottsym{:}  \tau}{%
{\ottdrulename{Exp\_Addition}}{}%
}}


\newcommand{\ottdruleExpXXPartyVar}[1]{\ottdrule[#1]{%
\ottpremise{\ottmv{G}  \ottsym{(}  \ottmv{x}  \ottsym{)}  \ottsym{=}  \ottsym{(}  \tau  \ottsym{,}   \mathcal{C}   \ottsym{)}}%
\ottpremise{\ottmv{G}  \ottsym{(}  \ottmv{A}  \ottsym{)}  \ottsym{=}  \ottsym{(}  \ottkw{Party}  \ottsym{,}   \mathcal{C}   \ottsym{)}}%
\ottpremise{\tau \, \in \, \ottsym{\{}  \ottkw{Port}  \ottsym{,}  \ottkw{Int}  \ottsym{\}}}%
}{
\ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C}   \vdash  \ottmv{A}  \ottsym{.}  \ottmv{x}  \ottsym{:}  \tau}{%
{\ottdrulename{Exp\_PartyVar}}{}%
}}


\newcommand{\ottdruleExpXXStatement}[1]{\ottdrule[#1]{%
\ottpremise{\ottmv{G}  \ottsym{(}  \ottmv{x}  \ottsym{)}  \ottsym{=}  \ottsym{(}  \ottkw{Int}  \ottsym{,}   \mathcal{C}   \ottsym{)}}%
}{
\ottmv{G}  \ottsym{,}  \mathcal{M}  \ottsym{,}  \rho  \ottsym{,}  \ottmv{S}  \ottsym{,}   \mathcal{C}   \vdash  \ottmv{x}  \ottsym{:}  \ottkw{Int}}{%
{\ottdrulename{Exp\_Statement}}{}%
}}

\newcommand{\ottdefnExp}[1]{\begin{ottdefnblock}[#1]{$\mathcal{E}  \vdash  \ottnt{exp}  \ottsym{:}  \tau$}{}
\ottusedrule{\ottdruleExpXXAddition{}}
\ottusedrule{\ottdruleExpXXPartyVar{}}
\ottusedrule{\ottdruleExpXXStatement{}}
\end{ottdefnblock}}


\newcommand{\ottdefnsJtype}{
\ottdefnConstant{}\ottdefnStmt{}\ottdefnWrapstmt{}\ottdefnProtocol{}\ottdefnExp{}}

% defns Jop

\newcommand{\ottdefnsJop}{
}

\newcommand{\ottdefnss}{
\ottdefnsJtype
\ottdefnsJop
}

\newcommand{\ottall}{\ottmetavars\\[0pt]
\ottgrammar\\[5.0mm]
\ottdefnss}

\begin{document}
\ottall

\begin{verbatim}
Definition rules:        21 good    0 bad
Definition rule clauses: 79 good    0 bad
\end{verbatim}
\end{document}
